(function(e){e.fn.magnify=function(q){var f=e.extend({debug:!1,speed:100,onload:function(){}},q),a,h,b,c,l=0,m=0,p=function(g,n){if(g){var d=new Image;e(d).on({load:function(){b.css("display","block");b.parent(".magnify").length||b.wrap('<div class="magnify"></div>');h=b.parent(".magnify");b.prev(".magnify-lens").length?h.children(".magnify-lens").css("background-image","url("+g+")"):b.before('<div class="magnify-lens loading" style="background:url('+g+') no-repeat 0 0"></div>');c=h.children(".magnify-lens");c.removeClass("loading");l=d.width;m=d.height;f.debug&&console.log("[MAGNIFY] Got zoom image dimensions OK (width x height): "+l+" x "+m);d=null;f.onload();h.mousemove(function(a){var d=h.offset(),k=a.pageX-d.left,e=a.pageY-d.top;k<h.width()&&e<h.height()&&0<k&&0<e?c.fadeIn(f.speed):c.fadeOut(f.speed);if(c.is(":visible")){a=k-c.width()/2;d=e-c.height()/2;if(l&&m)var k=-1*Math.round(k/b.width()*l-c.width()/2),g=-1*Math.round(e/b.height()*m-c.height()/2),g=k+"px "+g+"px";c.css({top:Math.round(d)+"px",left:Math.round(a)+"px",backgroundPosition:g||""})}}).mouseleave(function(){c.css("display","none")});a.length&&(a.css("display","inline-block"),(n||a.attr("href")&&!b.attr("data-magnify-src")&&!f.src)&&a.click(function(a){a.preventDefault()}))},error:function(){d=null;n?f.debug&&console.log("[MAGNIFY] Parent anchor zoom source is invalid also. Disabling zoom..."):(f.debug&&console.log("[MAGNIFY] Invalid data-magnify-src. Looking in parent anchor instead -> "+a.attr("href")),p(a.attr("href"),!0))}});d.src=g}};return this.each(function(){b=e(this);a=b.parents("a");p(b.attr("data-magnify-src")||f.src||a.attr("href")||"")})}})(jQuery);